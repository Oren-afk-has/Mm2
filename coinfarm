local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local TeleportService = game:GetService("TeleportService")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local hrp = character:WaitForChild("HumanoidRootPart")

local found = false
local riftToTeleport = nil
local placeId = 85896571713843  -- Your PlaceId

-- Function to check if any event rift exists
local function hasEventRifts()
    for _, rift in ipairs(workspace.Rendered.Rifts:GetChildren()) do
        if rift.Name == "event-1" or rift.Name == "event-2" then
            return true
        end
    end
    return false
end

for _, rift in ipairs(workspace.Rendered.Rifts:GetChildren()) do
    if rift.Name == "event-1" or rift.Name == "event-2" then
        local luck = rift:FindFirstChild("Display") and rift.Display:FindFirstChild("SurfaceGui") and rift.Display.SurfaceGui:FindFirstChild("Icon") and rift.Display.SurfaceGui.Icon:FindFirstChild("Luck")
        if luck and luck:IsA("TextLabel") then
            found = true

            if not rift.PrimaryPart then
                local firstPart = rift:FindFirstChildWhichIsA("BasePart")
                if firstPart then
                    rift.PrimaryPart = firstPart
                end
            end

            local targetPart = rift.PrimaryPart
            if targetPart then
                local goal = {
                    CFrame = targetPart.CFrame * CFrame.new(0, 5, -5)
                }

                local tweenInfo = TweenInfo.new(15, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
                local tween = TweenService:Create(hrp, tweenInfo, goal)
                tween:Play()
                tween.Completed:Wait()

                local eventRemote = ReplicatedStorage:WaitForChild("Shared"):WaitForChild("Framework"):WaitForChild("Network"):WaitForChild("Remote"):WaitForChild("Event")

                while true do
                    if rift.Name == "event-1" then
                        local args = {
                            [1] = "HatchEgg",
                            [2] = "Bunny Egg",
                            [3] = 4
                        }
                        eventRemote:FireServer(unpack(args))
                    elseif rift.Name == "event-2" then
                        local args = {
                            [1] = "HatchEgg",
                            [2] = "Pastel Egg",
                            [3] = 4
                        }
                        eventRemote:FireServer(unpack(args))
                    end

                    task.wait(0.1)
                end
            end

            riftToTeleport = rift
            break
        end
    end
end

-- Monitor if the rift has despawned and check for remaining rifts
if riftToTeleport then
    local riftDespawned = false
    riftToTeleport.Destroyed:Connect(function()
        riftDespawned = true
    end)

    -- Wait until rift despawns
    repeat
        task.wait(1)
    until riftDespawned

    -- Check if there are still event rifts left
    if not hasEventRifts() then
        -- Teleport to a completely new server (guaranteed)
        TeleportService:Teleport(placeId, player)
    end
end
